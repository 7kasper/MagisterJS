<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Appointment.coffee - Magister.js Docs</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://i.imgur.com/Lrg80ax.png" title="Magister.js Docs"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.20.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AbsenceInfo.html">AbsenceInfo</a></li>
                                <li><a href="../classes/AddressInfo.html">AddressInfo</a></li>
                                <li><a href="../classes/Appointment.html">Appointment</a></li>
                                <li><a href="../classes/Assignment.html">Assignment</a></li>
                                <li><a href="../classes/AssignmentVersion.html">AssignmentVersion</a></li>
                                <li><a href="../classes/Class.html">Class</a></li>
                                <li><a href="../classes/Course.html">Course</a></li>
                                <li><a href="../classes/DigitalSchoolUtility.html">DigitalSchoolUtility</a></li>
                                <li><a href="../classes/File.html">File</a></li>
                                <li><a href="../classes/FileFolder.html">FileFolder</a></li>
                                <li><a href="../classes/Grade.html">Grade</a></li>
                                <li><a href="../classes/GradePeriod.html">GradePeriod</a></li>
                                <li><a href="../classes/GradeType.html">GradeType</a></li>
                                <li><a href="../classes/Magister.html">Magister</a></li>
                                <li><a href="../classes/MagisterSchool.html">MagisterSchool</a></li>
                                <li><a href="../classes/Message.html">Message</a></li>
                                <li><a href="../classes/MessageFolder.html">MessageFolder</a></li>
                                <li><a href="../classes/Person.html">Person</a></li>
                                <li><a href="../classes/ProfileInfo.html">ProfileInfo</a></li>
                                <li><a href="../classes/ProfileSettings.html">ProfileSettings</a></li>
                                <li><a href="../classes/StudyGuide.html">StudyGuide</a></li>
                                <li><a href="../classes/StudyGuidePart.html">StudyGuidePart</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Magister.html">Magister</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: Appointment.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
root = (module?.exports ? this.Magister ?= {})

###*
# An appointment.
#
# @class Appointment
# @private
# @param _magisterObj {Magister} A Magister object this Appointment is child of.
# @constructor
###
class root.Appointment
	constructor: (@_magisterObj) -&gt;
		###*
		# @property id
		# @final
		# @type Number
		###
		@id = root._getset &quot;_id&quot;
		###*
		# @property begin
		# @final
		# @type Date|undefined
		###
		@begin = root._getset &quot;_begin&quot;
		###*
		# @property end
		# @final
		# @type Date|undefined
		###
		@end = root._getset &quot;_end&quot;
		###*
		# @property beginBySchoolHour
		# @final
		# @type Number
		###
		@beginBySchoolHour = root._getset &quot;_beginBySchoolHour&quot;
		###*
		# @property endBySchoolHour
		# @final
		# @type Number
		###
		@endBySchoolHour = root._getset &quot;_endBySchoolHour&quot;
		###*
		# @property fullDay
		# @final
		# @type Boolean
		###
		@fullDay = root._getset &quot;_fullDay&quot;
		###*
		# @property description
		# @final
		# @type String
		###
		@description = root._getset &quot;_description&quot;
		###*
		# @property location
		# @final
		# @type String
		###
		@location = root._getset &quot;_location&quot;
		###*
		# @property status
		# @final
		# @type Number
		###
		@status = root._getset &quot;_status&quot;
		###*
		# @property type
		# @final
		# @type Number
		###
		@type = root._getset &quot;_type&quot;
		###*
		# type parsed as a string.
		# @property typeString
		# @final
		# @type String
		###
		@typeString = root._getset &quot;_type&quot;, null, (x) -&gt;
			switch x
				when 0 then &#x27;none&#x27;
				when 1 then &#x27;personal&#x27;
				when 2 then &#x27;general&#x27;
				when 3 then &#x27;schoolwide&#x27;
				when 4 then &#x27;internship&#x27;
				when 5 then &#x27;intake&#x27;
				when 6 then &#x27;scheduleFree&#x27;
				when 7 then &#x27;kwt&#x27;
				when 8 then &#x27;standby&#x27;
				when 9 then &#x27;block&#x27;
				when 10 then &#x27;miscellaneous&#x27;
				when 11 then &#x27;localBlock&#x27;
				when 12 then &#x27;classBlock&#x27;
				when 13 then &#x27;lesson&#x27;
				when 14 then &#x27;studiehuis&#x27;
				when 15 then &#x27;scheduleFreeStudy&#x27;
				when 16 then &#x27;planning&#x27;
				# what&#x27;s up with this big hole here, schoolmaster?
				when 101 then &#x27;actions&#x27;
				when 102 then &#x27;presences&#x27;
				when 103 then &#x27;examSchedule&#x27;

				else &#x27;unknown&#x27;
		###*
		# @property displayType
		# @final
		# @type Number
		###
		@displayType = root._getset &quot;_displayType&quot;
		###*
		# displayType parsed as a string.
		# @property displayTypeString
		# @final
		# @type String
		###
		@displayTypeString = root._getset &quot;_displayType&quot;, null, (x) -&gt;
			switch x
				when 1 then &#x27;available&#x27;
				when 2 then &#x27;provisionallyScheduled&#x27;
				when 3 then &#x27;scheduled&#x27;
				when 4 then &#x27;absent&#x27;

				else &#x27;unknown&#x27;
		###*
		# @property content
		# @final
		# @type String
		###
		@content = root._getset &quot;_content&quot;, null, root._helpers.cleanHtmlContent
		###*
		# @property infoType
		# @final
		# @type Number
		###
		@infoType = root._getset &quot;_infoType&quot;
		###*
		# infoType parsed as a string.
		# @property infoTypeString
		# @final
		# @type String
		###
		@infoTypeString = root._getset &quot;_infoType&quot;, null, (x) -&gt;
			switch x
				when 0 then &#x27;none&#x27;
				when 1 then &#x27;homework&#x27;
				when 2 then &#x27;test&#x27;
				when 3 then &#x27;exam&#x27;
				when 4 then &#x27;quiz&#x27;
				when 5 then &#x27;oral&#x27;
				when 6 then &#x27;information&#x27;
				when 7 then &#x27;annotation&#x27;

				else &#x27;unknown&#x27;
		###*
		# @property notes
		# @final
		# @type String
		###
		@notes = root._getset &quot;_notes&quot;
		###*
		# @property isDone
		# @type Boolean
		###
		@isDone = root._getset &quot;_isDone&quot;, (d) =&gt;
			return if @_isDone is d

			@_isDone = d
			@_magisterObj.http.put @url(), @_toMagisterStyle(), {}, (-&gt;)
		###*
		# @property classes
		# @final
		# @type String[]
		###
		@classes = root._getset &quot;_classes&quot;
		###*
		# @property teachers
		# @final
		# @type Person[]
		###
		@teachers = root._getset &quot;_teachers&quot;
		###*
		# @property classRooms
		# @final
		# @type String[]
		###
		@classRooms = root._getset &quot;_classRooms&quot;
		###*
		# @property groups
		# @final
		# @type String[]
		###
		@groups = root._getset &quot;_groups&quot;
		###*
		# @property appointmentId
		# @final
		# @type Number
		###
		@appointmentId = root._getset &quot;_appointmentId&quot;
		###*
		# @property url
		# @final
		# @type String
		###
		@url = root._getset &quot;_url&quot;
		###*
		# @property scrapped
		# @final
		# @type Boolean
		###
		@scrapped = root._getset &quot;_scrapped&quot;
		###*
		# @property changed
		# @final
		# @type Boolean
		###
		@changed = root._getset &quot;_changed&quot;
		###*
		# @property absenceInfo
		# @final
		# @type AbsenceInfo
		###
		@absenceInfo = root._getset &quot;_absenceInfo&quot;

	###*
	# Gets the attachments for the current Appointment.
	# @method attachments
	# @param callback {Function} A standard callback.
	# 	@param [callback.error] {Object} The error, if it exists.
	# 	@param [callback.result] {File[]} An array containing the attachments.
	###
	attachments: (cb) -&gt;
		unless @_hasAttachments
			cb null, []
			return

		@_magisterObj.http.get @_url, {}, (error, result) =&gt;
			if error? then cb error, null
			else
				parsed = JSON.parse(result.content).Bijlagen
				person = @_teachers[0]

				cb null, parsed.map (f) =&gt;
					f._addedBy = person
					root.File._convertRaw @_magisterObj, undefined, f

		undefined

	###*
	# WARNING. Removes the current Appointment if created by the user.
	# @method remove
	# @param [callback] {Function} An optional callback.
	# 	@param [callback.error] {Object} An error, if it exists.
	###
	remove: (cb) -&gt;
		# quit if this appointment isn&#x27;t made by the user.
		return unless @_type in [ 1, 16 ]
		@_magisterObj.http.delete @_url, {}, (e, r) -&gt; cb e

	_toMagisterStyle: -&gt;
		obj = {}

		obj.Id = @_id
		obj.Start = root._helpers.toUtcString @_begin
		obj.Einde = root._helpers.toUtcString @_end
		obj.LesuurVan = @_beginBySchoolHour
		obj.LesuurTotMet = @_endBySchoolHour
		obj.DuurtHeleDag = @_fullDay
		obj.Omschrijving = @_description
		obj.Lokatie = @_location
		obj.Status = @_status
		obj.Type = @_type
		obj.WeergaveType = @_displayType
		obj.Inhoud = @_content
		obj.InfoType = @_infoType
		obj.Aantekening = @_notes
		obj.Afgerond = @_isDone
		obj.Lokalen = ( { Naam: c } for c in @_classRooms )
		obj.Docenten = ( p._toMagisterStyle() for p in @_teachers )
		obj.Vakken = ( { Naam: c } for c in @_classes )
		obj.Groepen = @_groups
		obj.OpdrachtId = @_appointmentId
		obj.Bijlagen = []

		obj

	@_convertRaw: (magisterObj, raw) -&gt;
		obj = new root.Appointment magisterObj

		obj._id = raw.Id
		obj._begin = root._helpers.parseDate raw.Start
		obj._end = root._helpers.parseDate raw.Einde
		obj._beginBySchoolHour = raw.LesuurVan
		obj._endBySchoolHour = raw.LesuurTotMet
		obj._fullDay = raw.DuurtHeleDag
		obj._description = raw.Omschrijving ? &quot;&quot;
		obj._location = raw.Lokatie ? &quot;&quot;
		obj._status = raw.Status
		obj._type = raw.Type
		obj._displayType = raw.WeergaveType
		obj._content = raw.Inhoud
		obj._infoType = raw.InfoType
		obj._notes = raw.Aantekening
		obj._isDone = raw.Afgerond
		obj._classes = if raw.Vakken? then (c.Naam for c in raw.Vakken) else []
		obj._teachers = if raw.Docenten? then (root.Person._convertRaw(magisterObj, p) for p in raw.Docenten) else []
		obj._classRooms = if raw.Lokalen? then (c.Naam for c in raw.Lokalen) else []
		obj._groups = raw.Groepen # ?
		obj._appointmentId = raw.OpdrachtId
		obj._hasAttachments = raw.HeeftBijlagen
		obj._url = &quot;#{magisterObj._personUrl}/afspraken/#{obj._id}&quot;
		obj._scrapped = raw.Status in [ 4, 5 ]
		obj._changed = raw.Status in [ 3, 9, 10 ]

		obj

	@_convertStored: (magisterObj, raw) -&gt;
		obj = _.extend raw, new root.Appointment magisterObj
		obj._magisterObj = magisterObj
		obj._begin = root._helpers.parseDate raw._begin
		obj._end = root._helpers.parseDate raw._end
		obj

###*
# Info about absence for an appointment.
#
# @class AbsenceInfo
# @private
# @param _magisterObj {Magister} A Magister object this AbsenceInfo is child of.
# @constructor
###
class root.AbsenceInfo
	constructor: (@_magisterObj) -&gt;
		###*
		# @property id
		# @final
		# @type Number
		###
		@id = root._getset &quot;_id&quot;
		###*
		# @property begin
		# @final
		# @type Date|undefined
		###
		@begin = root._getset &quot;_begin&quot;
		###*
		# @property end
		# @final
		# @type Date|undefined
		###
		@end = root._getset &quot;_end&quot;
		###*
		# @property schoolHour
		# @final
		# @type Number
		###
		@schoolHour = root._getset &quot;_schoolHour&quot;
		###*
		# @property permitted
		# @final
		# @type Boolean
		###
		@permitted = root._getset &quot;_permitted&quot;
		###*
		# @property description
		# @final
		# @type String
		###
		@description = root._getset &quot;_description&quot;
		###*
		# @property type
		# @final
		# @type Number
		###
		@type = root._getset &quot;_type&quot;
		###*
		# type parsed as a string.
		# @property typeString
		# @final
		# @type String
		###
		@typeString = root._getset &quot;_type&quot;, null, (x) -&gt;
			switch x
				when 1 then &#x27;absent&#x27;
				when 2 then &#x27;late&#x27;
				when 3 then &#x27;sick&#x27;
				when 4 then &#x27;discharged&#x27;
				when 6 then &#x27;exemption&#x27;
				when 7 then &#x27;books&#x27;
				when 8 then &#x27;homework&#x27;

				else &#x27;unknown&#x27;
		###*
		# @property code
		# @final
		# @type String
		###
		@code = root._getset &quot;_code&quot;
		###*
		# @property appointment
		# @final
		# @type Appointment
		###
		@appointment = root._getset &quot;_appointment&quot;

	@_convertRaw: (magisterObj, raw) -&gt;
		obj = new root.AbsenceInfo magisterObj

		obj._id = raw.Id
		obj._begin = root._helpers.parseDate raw.Start
		obj._end = root._helpers.parseDate raw.Eind
		obj._schoolHour = raw.Lesuur
		obj._permitted = raw.Geoorloofd
		obj._description = raw.Omschrijving?.trim() ? &#x27;&#x27;
		obj._type = raw.Verantwoordingtype
		obj._code = raw.Code ? &#x27;&#x27;
		obj._appointment = root.Appointment._convertRaw magisterObj, raw.Afspraak

		obj

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
