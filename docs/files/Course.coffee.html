<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Course.coffee - Magister.js Docs</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="http://i.imgur.com/Lrg80ax.png" title="Magister.js Docs"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.3.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Appointment.html">Appointment</a></li>
                                <li><a href="../classes/Assignment.html">Assignment</a></li>
                                <li><a href="../classes/AssignmentVersion.html">AssignmentVersion</a></li>
                                <li><a href="../classes/Class.html">Class</a></li>
                                <li><a href="../classes/Course.html">Course</a></li>
                                <li><a href="../classes/DetailedProfileInfo.html">DetailedProfileInfo</a></li>
                                <li><a href="../classes/DigitalSchoolUtility.html">DigitalSchoolUtility</a></li>
                                <li><a href="../classes/File.html">File</a></li>
                                <li><a href="../classes/FileFolder.html">FileFolder</a></li>
                                <li><a href="../classes/Grade.html">Grade</a></li>
                                <li><a href="../classes/GradeType.html">GradeType</a></li>
                                <li><a href="../classes/Magister.html">Magister</a></li>
                                <li><a href="../classes/MagisterSchool.html">MagisterSchool</a></li>
                                <li><a href="../classes/Message.html">Message</a></li>
                                <li><a href="../classes/MessageFolder.html">MessageFolder</a></li>
                                <li><a href="../classes/Person.html">Person</a></li>
                                <li><a href="../classes/ProfileInfo.html">ProfileInfo</a></li>
                                <li><a href="../classes/StudyGuide.html">StudyGuide</a></li>
                                <li><a href="../classes/StudyGuidePart.html">StudyGuidePart</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/Magister.html">Magister</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: Course.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
root = (module?.exports ? this.Magister ?= {})

###*
# A Class (ex. English class)
#
# @class Class
# @private
# @constructor
# @param _magisterObj {Magister} A Magister object this Class is child of.
###
class root.Class
	constructor: (@_magisterObj) -&gt;
		###*
		# @property id
		# @final
		# @type Number
		###
		@id = root._getset &quot;_id&quot;
		###*
		# @property beginDate
		# @final
		# @type Date
		###
		@beginDate = root._getset &quot;_beginDate&quot;
		###*
		# @property endDate
		# @final
		# @type Date
		###
		@endDate = root._getset &quot;_endDate&quot;
		###*
		# @property abbreviation
		# @final
		# @type String
		###
		@abbreviation = root._getset &quot;_abbreviation&quot;
		###*
		# @property description
		# @final
		# @type String
		###
		@description = root._getset &quot;_description&quot;
		###*
		# @property number
		# @final
		# @type Number
		###
		@number = root._getset &quot;_number&quot;
		###*
		# @property teacher
		# @final
		# @type Person
		###
		@teacher = root._getset &quot;_teacher&quot;
		###*
		# @property classExemption
		# @final
		# @type Boolean
		###
		@classExemption = root._getset &quot;_classExemption&quot;

	@_convertRaw: (magisterObj, raw) -&gt;
		obj = new root.Class magisterObj

		obj._id = raw.id ? raw.Id
		obj._beginDate = new Date Date.parse raw.begindatum
		obj._endDate = new Date Date.parse raw.einddatum
		obj._abbreviation = raw.afkorting ? raw.Afkorting
		obj._description = raw.omschrijving ? raw.Omschrijving
		obj._number = raw.volgnr ? raw.Volgnr
		obj._teacher = root.Person._convertRaw magisterObj, Docentcode: raw.docent
		obj._classExemption = raw.VakDispensatie or raw.VakVrijstelling

		return obj

###*
# A Course (like: 4 VWO E/M 14-15).
#
# @class Course
# @private
# @param _magisterObj {Magister} A Magister object this Course is child of.
# @constructor
###
class root.Course
	constructor: (@_magisterObj) -&gt;
		###*
		# @property id
		# @final
		# @type Number
		###
		@id = root._getset &quot;_id&quot;
		###*
		# @property begin
		# @final
		# @type Date
		###
		@begin = root._getset &quot;_begin&quot;
		###*
		# @property end
		# @final
		# @type Date
		###
		@end = root._getset &quot;_end&quot;
		###*
		# The &#x27;school period&#x27; of this Course (e.g: &quot;1415&quot;).
		# @property schoolPeriod
		# @final
		# @type String
		###
		@schoolPeriod = root._getset &quot;_schoolPeriod&quot;
		###*
		# Type of this Course (e.g: { description: &quot;VWO 4&quot;, id: 420 }).
		# @property type
		# @final
		# @type Object
		###
		@type = root._getset &quot;_type&quot;
		###*
		# The group of this Course contains the class the user belongs to (e.g: { description: &quot;Klas 4v3&quot;, id: 420, locationId: 0 }).
		# @property group
		# @final
		# @type Object
		###
		@group = root._getset &quot;_group&quot;
		###*
		# The &#x27;profile&#x27; of this Course (e.g: &quot;A-EM&quot;).
		# @property profile
		# @final
		# @type String
		###
		@profile = root._getset &quot;_profile&quot;
		###*
		# An alternative profile, if it exists (e.g: &quot;A-EM&quot;).
		# @property alternativeProfile
		# @final
		# @type String
		###
		@alternativeProfile = root._getset &quot;_alternativeProfile&quot;

	###*
	# Gets the classes of this Course.
	#
	# @method classes
	# @async
	# @param callback {Function} A standard callback.
	# 	@param [callback.error] {Object} The error, if it exists.
	# 	@param [callback.result] {Class[]} An array containing the Classes.
	###
	classes: (callback) -&gt;
		@_magisterObj.http.get @_classesUrl, {}, (error, result) =&gt;
			if error?
				callback error, null
			else
				callback null, (root.Class._convertRaw @_magisterObj, c for c in JSON.parse(result.content))

	###*
	# Gets the grades of this Course.
	#
	# @method grades
	# @async
	# @param [fillPersons=true] {Boolean} Whether or not to download the full user objects from the server.
	# @param [fillGrade=true] {Boolean} Whether or not to download the full grade info should be downloaded from the server. If this is set to false some properties will be not be set or have incorrect values.
	# @param [onlyRecent=false] {Boolean} If true this method will only fetch the grades filled in between 7 days ago and now.
	# @param callback {Function} A standard callback.
	# 	@param [callback.error] {Object} The error, if it exists.
	# 	@param [callback.result] {Grade[]} An array containing the Grades.
	###
	grades: -&gt;
		[fillPersons, fillGrade, onlyRecent] = _.filter arguments, (a) -&gt; _.isBoolean a
		callback = _.find(arguments, (a) -&gt; _.isFunction a)
		throw new Error &quot;Callback can&#x27;t be null&quot; unless callback?

		fillPersons ?= yes
		fillGrade ?= yes
		onlyRecent ?= no

		@_magisterObj.http.get (if onlyRecent then @_gradesUrlPrefix else @_gradesUrl), {}, (error, result) =&gt;
			if error?
				callback error, null
			else
				result = JSON.parse(result.content).Items
				pushResult = root._helpers.asyncResultWaiter result.length, (r) -&gt;
					for c in _.uniq(r, (g) -&gt; g.class().id()).map((g) -&gt; g.class())
						for g in _.filter(r, (g) -&gt; g.class().id() is c.id())
							g._class = c

					callback null, _.sortBy r, (g) -&gt; g.dateFilledIn()

				for raw in result
					do (raw) =&gt;
						g = root.Grade._convertRaw @_magisterObj, raw
						g._columnUrl = @_columnUrlPrefix + raw.CijferKolom?.Id

						push = root._helpers.asyncResultWaiter 2, -&gt; pushResult g

						if fillPersons and not onlyRecent
							@_magisterObj.getPersons g.Docent, 3, (e, r) -&gt;
								unless e? or not r[0]? then g._teacher = r[0]
								push()
						else push()

						if fillGrade and not onlyRecent
							g.fillGrade (e, r) -&gt;
								if e? then callback e, null
								else push()
						else push()

	###*
	# Gets the perosnal tutor of the current user for this Course.
	#
	# @method getPersonalTutor
	# @param callback {Function} A standard callback.
	# 	@param [callback.error] {Object} The error, if it exists.
	# 	@param [callback.result] {Person} The tutor as a Person object.
	###
	getPersonalTutor: (callback) -&gt;
		throw new Error &quot;Callback can&#x27;t be null&quot; unless callback?

		@_magisterObj.http.get &quot;#{@_magisterObj._personUrl}/aanmeldingen/#{@_id}/mentor&quot;, {}, (error, result) =&gt;
			if error? then callback error, null
			else callback null, root.Person._convertRaw @_magisterObj, JSON.parse result.content

	###*
	# Gets the (group / class) tutors.
	#
	# @method getOtherTutors
	# @param callback {Function} A standard callback.
	# 	@param [callback.error] {Object} The error, if it exists.
	# 	@param [callback.result] {Person} The tutor as a Person object.
	###
	getOtherTutors: (callback) =&gt;
		throw new Error &quot;Callback can&#x27;t be null&quot; unless callback?

		@_magisterObj.http.get &quot;#{@_magisterObj._personUrl}/aanmeldingen/#{@_id}/mentor&quot;, {}, (error, result) =&gt;
			if error? then callback error, null
			else
				items = JSON.parse(result.content).items # Really SchoolMaster, get consistent with using da capz.
				callback null, (root.Person._convertRaw @_magisterObj, p for p in items)

	@_convertRaw: (magisterObj, raw) -&gt;
		obj = new root.Course magisterObj

		obj._classesUrl = magisterObj._personUrl + &quot;/aanmeldingen/#{raw.Id}/vakken&quot;

		obj._gradesUrlPrefix = magisterObj._personUrl + &quot;/aanmeldingen/#{raw.Id}/cijfers&quot;
		obj._gradesUrl = obj._gradesUrlPrefix + &quot;/cijferoverzichtvooraanmelding?actievePerioden=false&amp;alleenBerekendeKolommen=false&amp;alleenPTAKolommen=false&quot;
		obj._columnUrlPrefix = obj._gradesUrlPrefix + &quot;/extracijferkolominfo/&quot;

		obj._id = raw.Id
		obj._begin = new Date Date.parse raw.Start
		obj._end = new Date Date.parse raw.Einde
		obj._schoolPeriod = raw.Lesperiode
		obj._type = { id: raw.Studie.Id, description: raw.Studie.Omschrijving }
		obj._group = { id: raw.Groep.Id, description: raw.Groep.Omschrijving, locationId: raw.Groep.LocatieId }
		obj._profile = raw.Profiel
		obj._alternativeProfile = raw.Profiel2

		return obj

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
